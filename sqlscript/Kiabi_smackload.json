{
	"name": "Kiabi_smackload",
	"properties": {
		"content": {
			"query": "Drop TABLE Kiabi.smack\nIF NOT EXISTS (SELECT * FROM sys.objects WHERE NAME = 'smack' AND TYPE = 'U')\nCREATE TABLE Kiabi.smack\n\t(\n\t customer_rowid varchar(4000),\n\t customer_create_date varchar(4000),\n\t gender varchar(4000),\n\t loyalty_card BIGINT,\n\t loyalty_card_status varchar(4000),\n\t personnel_kiabi varchar(4000),\n\t flag_shared_loyalty_card varchar(4000),\n\t customer_country varchar(4000),\n\t customer_country_label varchar(4000),\n\t birthdate varchar(4000),\n\t slice_age varchar(4000),\n\t address_quality_score bigint,\n\t top_has_address varchar(4000),\n\t top_has_telfixe varchar(4000),\n\t top_has_gsm varchar(4000),\n\t top_has_optinsms varchar(4000),\n\t optin_email_kiabi varchar(4000),\n\t optin_email_part varchar(4000),\n\t nb_child bigint,\n\t nb_child_boy bigint,\n\t nb_child_girl bigint,\n\t nb_child_unknown bigint,\n\t first_purchase_date varchar(4000),\n\t first_ticket_date varchar(4000),\n\t first_order_date varchar(4000),\n\t most_used_tckt_pay varchar(4000),\n\t most_used_tckt_pay_12rm varchar(4000),\n\t code_store_lastpurchase varchar(4000),\n\t lati_store_lastpurchase varchar(4000),\n\t long_store_lastpurchase varchar(4000),\n\t tckt_last_purchase_date varchar(4000),\n\t order_last_purchase_date varchar(4000),\n\t last_purchase_date varchar(4000),\n\t code_store_attac varchar(4000),\n\t lati_store_attac varchar(4000),\n\t long_store_attac varchar(4000),\n\t code_store_open varchar(4000),\n\t lati_store_open varchar(4000),\n\t long_store_open varchar(4000),\n\t nb_product_tckt_maternity_12rm bigint,\n\t nb_tckt_return_1rm bigint,\n\t nb_tckt_return_6rm bigint,\n\t nb_tckt_return_12rm bigint,\n\t nb_tckt_return_18rm bigint,\n\t nb_tckt_return_24rm bigint,\n\t nb_tckt_return_36rm bigint,\n\t nb_tckt_return_48rm bigint,\n\t nb_tckt_return_all bigint,\n\t nb_tckt_1rm bigint,\n\t nb_tckt_6rm bigint,\n\t nb_tckt_12rm bigint,\n\t nb_tckt_18rm bigint,\n\t nb_tckt_24rm bigint,\n\t nb_tckt_36rm bigint,\n\t nb_tckt_48rm bigint,\n\t nb_tckt_all bigint,\n\t nb_product_order_maternity_12rm bigint,\n\t nb_order_1rm BIGINT,\n\t nb_order_6rm bigint,\n\t nb_order_12rm bigint,\n\t nb_order_18rm bigint,\n\t nb_order_24rm bigint,\n\t nb_order_36rm bigint,\n\t nb_order_48rm bigint,\n\t nb_order_all bigint,\n\t most_used_order_delivery varchar(4000),\n\t nb_order_desk_12rm bigint,\n\t nb_order_mobile_12rm bigint,\n\t nb_order_other_12rm bigint,\n\t most_used_order_pay varchar(4000),\n\t most_used_order_pay_12rm varchar(4000),\n\t nb_tckt_articles_1rm bigint,\n\t nb_tckt_articles_12rm bigint,\n\t nb_tckt_articles_all bigint,\n\t nb_tckt_return_articles_1rm bigint,\n\t nb_tckt_return_articles_12rm bigint,\n\t nb_tckt_return_articles_all bigint,\n\t nb_order_articles_1rm bigint,\n\t nb_order_articles_12rm bigint,\n\t net_sales_tckt_1rm float,\n\t net_sales_tckt_12rm float,\n\t net_sales_tckt_all float,\n\t net_sales_tckt_return_1rm float,\n\t net_sales_tckt_return_12rm float,\n\t net_sales_tckt_return_all float,\n\t net_sales_order_1rm float,\n\t net_sales_order_12rm float,\n\t nb_order_eresa_1rm bigint,\n\t nb_order_eresa_12rm bigint,\n\t nb_order_eresa_all bigint,\n\t potentiel_net_sales_eresa_1rm float,\n\t potentiel_net_sales_eresa_12rm float,\n\t potentiel_net_sales_eresa_all float,\n\t customer_activity_kind_1rm varchar(4000),\n\t customer_activity_kind_12rm varchar(4000),\n\t customer_activity_xcanal_1rm varchar(4000),\n\t customer_activity_xcanal_12rm varchar(4000),\n\t customer_activity_xcanal_all varchar(4000),\n\t product_groups_12rm varchar(4000),\n\t product_groups_1rm varchar(4000),\n\t product_groups_all varchar(4000),\n\t rfm_date_observation varchar(4000),\n\t rfm_min_date varchar(4000),\n\t rfm_t1 BIGINT,\n\t rfm_t2 BIGINT,\n\t rfm_t3 BIGINT,\n\t rfm_t4 BIGINT,\n\t rfm_frequence BIGINT,\n\t rfm_sum_ca_ttc float,\n\t rfm_scorerfm float,\n\t rfm_classerfm varchar(4000),\n\t rfm_cluster varchar(4000),\n\t cluster_style varchar(4000),\n\t net_sales_grbaby_fashion_12rm float,\n\t net_sales_grbaby_basic_12rm float,\n\t net_sales_grbaby_12rm float,\n\t net_sales_grkids_fashion_12rm float,\n\t net_sales_grkids_basic_12rm float,\n\t net_sales_grkids_12rm float,\n\t net_sales_grwomen_fashion_12rm float,\n\t net_sales_grwomen_basic_12rm float,\n\t net_sales_grwomen_12rm float,\n\t net_sales_grmen_fashion_12rm float,\n\t net_sales_grmen_basic_12rm float,\n\t net_sales_grmen_12rm float,\n\t net_sales_grunderwear_fashion_12rm float,\n\t net_sales_grunderwear_basic_12rm float,\n\t net_sales_grunderwear_12rm float,\n\t net_sales_grshoes_fashion_12rm float,\n\t net_sales_grshoes_basic_12rm float,\n\t net_sales_grshoes_12rm float,\n\t net_sales_graccess_fashion_12rm float,\n\t net_sales_graccess_basic_12rm float,\n\t net_sales_graccess_12rm float,\n\t net_sales_grexcluweb_fashion_12rm float,\n\t net_sales_grexcluweb_basic_12rm float,\n\t net_sales_grexcluweb_12rm float,\n\t xcanal_cluster_12rm varchar(4000),\n\t attac_store_dist float,\n\t nearest_store varchar(4000),\n\t nearest_store_dist float,\n\t net_sales_tckt_pvi_1rm float,\n\t net_sales_tckt_pvi_12rm float,\n\t net_sales_order_pvi_1rm float,\n\t net_sales_order_pvi_12rm float,\n\t class_grwomen varchar(4000),\n\t class_grmen varchar(4000),\n\t class_grshoes varchar(4000),\n\t class_grbaby varchar(4000),\n\t class_grexcluweb varchar(4000),\n\t class_graccess varchar(4000),\n\t class_grconsign varchar(4000),\n\t class_grhome varchar(4000),\n\t class_grkids varchar(4000),\n\t class_grunderwear varchar(4000),\n\t first_purchase_canal varchar(4000),\n\t slice_first_purchase_date varchar(4000),\n\t score_mixite float,\n\t main_appetence varchar(4000),\n\t secondary_appetence varchar(4000),\n\t marketappetence varchar(4000),\n\t departmentappetence varchar(4000),\n\t net_sales_tckt_6rm float,\n\t net_sales_tckt_18rm float,\n\t net_sales_tckt_24rm float,\n\t net_sales_tckt_36rm float,\n\t net_sales_order_6rm float,\n\t net_sales_order_18rm float,\n\t net_sales_order_24rm float,\n\t net_sales_order_36rm float,\n\t net_sales_order_all float,\n\t nb_etckt_1rm BIGINT,\n\t nb_etckt_6rm BIGINT,\n\t nb_etckt_12rm BIGINT,\n\t nb_etckt_all BIGINT,\n\t net_sales_etckt_1rm float,\n\t net_sales_etckt_6rm float,\n\t net_sales_etckt_12rm float,\n\t net_sales_etckt_all float,\n\t cluster_evol_nb_24_12rm varchar(4000),\n\t cluster_evol_nb_12rm varchar(4000),\n\t cluster_evol_net_sales_24_12rm varchar(4000),\n\t cluster_evol_net_sales_12rm varchar(4000),\n\t percent_evol_net_sales_12rm float,\n\t slice_evol_net_sales_12rm varchar(4000),\n\t customer_activity_xcanal_12rm_lastyear varchar(4000),\n\t rfm_cluster_lastyear varchar(4000),\n\t cluster_style_lastyear varchar(4000),\n\t flag_anonymous varchar(4000),\n\t dt_observation varchar(4000),\n\t tec_dt_insert varchar(4000),\n\t period varchar(4000)\n\t)\nWITH\n\t(\n\tDISTRIBUTION = HASH(customer_rowid),\n\t CLUSTERED COLUMNSTORE INDEX\n\t -- HEAP\n\t)\nGO\n\n--Uncomment the 4 lines below to create a stored procedure for data pipeline orchestrationâ€‹                 \n--CREATE PROC bulk_load_smack\n--AS\n--BEGIN\nCOPY INTO Kiabi.smack\n(customer_rowid 1, customer_create_date 2, gender 3, loyalty_card 4, loyalty_card_status 5, personnel_kiabi 6, flag_shared_loyalty_card 7, customer_country 8, customer_country_label 9, birthdate 10, slice_age 11, address_quality_score 12, top_has_address 13, top_has_telfixe 14, top_has_gsm 15, top_has_optinsms 16, optin_email_kiabi 17, optin_email_part 18, nb_child 19, nb_child_boy 20, nb_child_girl 21, nb_child_unknown 22, first_purchase_date 23, first_ticket_date 24, first_order_date 25, most_used_tckt_pay 26, most_used_tckt_pay_12rm 27, code_store_lastpurchase 28, lati_store_lastpurchase 29, long_store_lastpurchase 30, tckt_last_purchase_date 31, order_last_purchase_date 32, last_purchase_date 33, code_store_attac 34, lati_store_attac 35, long_store_attac 36, code_store_open 37, lati_store_open 38, long_store_open 39, nb_product_tckt_maternity_12rm 40, nb_tckt_return_1rm 41, nb_tckt_return_6rm 42, nb_tckt_return_12rm 43, nb_tckt_return_18rm 44, nb_tckt_return_24rm 45, nb_tckt_return_36rm 46, nb_tckt_return_48rm 47, nb_tckt_return_all 48, nb_tckt_1rm 49, nb_tckt_6rm 50, nb_tckt_12rm 51, nb_tckt_18rm 52, nb_tckt_24rm 53, nb_tckt_36rm 54, nb_tckt_48rm 55, nb_tckt_all 56, nb_product_order_maternity_12rm 57, nb_order_1rm 58, nb_order_6rm 59, nb_order_12rm 4000, nb_order_18rm 61, nb_order_24rm 62, nb_order_36rm 63, nb_order_48rm 64, nb_order_all 65, most_used_order_delivery 66, nb_order_desk_12rm 67, nb_order_mobile_12rm 68, nb_order_other_12rm 69, most_used_order_pay 70, most_used_order_pay_12rm 71, nb_tckt_articles_1rm 72, nb_tckt_articles_12rm 73, nb_tckt_articles_all 74, nb_tckt_return_articles_1rm 75, nb_tckt_return_articles_12rm 76, nb_tckt_return_articles_all 77, nb_order_articles_1rm 78, nb_order_articles_12rm 79, net_sales_tckt_1rm 80, net_sales_tckt_12rm 81, net_sales_tckt_all 82, net_sales_tckt_return_1rm 83, net_sales_tckt_return_12rm 84, net_sales_tckt_return_all 85, net_sales_order_1rm 86, net_sales_order_12rm 87, nb_order_eresa_1rm 88, nb_order_eresa_12rm 89, nb_order_eresa_all 90, potentiel_net_sales_eresa_1rm 91, potentiel_net_sales_eresa_12rm 92, potentiel_net_sales_eresa_all 93, customer_activity_kind_1rm 94, customer_activity_kind_12rm 95, customer_activity_xcanal_1rm 96, customer_activity_xcanal_12rm 97, customer_activity_xcanal_all 98, product_groups_12rm 99, product_groups_1rm 100, product_groups_all 101, rfm_date_observation 102, rfm_min_date 103, rfm_t1 104, rfm_t2 105, rfm_t3 106, rfm_t4 107, rfm_frequence 108, rfm_sum_ca_ttc 109, rfm_scorerfm 110, rfm_classerfm 111, rfm_cluster 112, cluster_style 113, net_sales_grbaby_fashion_12rm 114, net_sales_grbaby_basic_12rm 115, net_sales_grbaby_12rm 116, net_sales_grkids_fashion_12rm 117, net_sales_grkids_basic_12rm 118, net_sales_grkids_12rm 119, net_sales_grwomen_fashion_12rm 120, net_sales_grwomen_basic_12rm 121, net_sales_grwomen_12rm 122, net_sales_grmen_fashion_12rm 123, net_sales_grmen_basic_12rm 124, net_sales_grmen_12rm 125, net_sales_grunderwear_fashion_12rm 126, net_sales_grunderwear_basic_12rm 127, net_sales_grunderwear_12rm 128, net_sales_grshoes_fashion_12rm 129, net_sales_grshoes_basic_12rm 130, net_sales_grshoes_12rm 131, net_sales_graccess_fashion_12rm 132, net_sales_graccess_basic_12rm 133, net_sales_graccess_12rm 134, net_sales_grexcluweb_fashion_12rm 135, net_sales_grexcluweb_basic_12rm 136, net_sales_grexcluweb_12rm 137, xcanal_cluster_12rm 138, attac_store_dist 139, nearest_store 140, nearest_store_dist 141, net_sales_tckt_pvi_1rm 142, net_sales_tckt_pvi_12rm 143, net_sales_order_pvi_1rm 144, net_sales_order_pvi_12rm 145, class_grwomen 146, class_grmen 147, class_grshoes 148, class_grbaby 149, class_grexcluweb 150, class_graccess 151, class_grconsign 152, class_grhome 153, class_grkids 154, class_grunderwear 155, first_purchase_canal 156, slice_first_purchase_date 157, score_mixite 158, main_appetence 159, secondary_appetence 14000, marketappetence 161, departmentappetence 162, net_sales_tckt_6rm 163, net_sales_tckt_18rm 164, net_sales_tckt_24rm 165, net_sales_tckt_36rm 166, net_sales_order_6rm 167, net_sales_order_18rm 168, net_sales_order_24rm 169, net_sales_order_36rm 170, net_sales_order_all 171, nb_etckt_1rm 172, nb_etckt_6rm 173, nb_etckt_12rm 174, nb_etckt_all 175, net_sales_etckt_1rm 176, net_sales_etckt_6rm 177, net_sales_etckt_12rm 178, net_sales_etckt_all 179, cluster_evol_nb_24_12rm 180, cluster_evol_nb_12rm 181, cluster_evol_net_sales_24_12rm 182, cluster_evol_net_sales_12rm 183, percent_evol_net_sales_12rm 184, slice_evol_net_sales_12rm 185, customer_activity_xcanal_12rm_lastyear 186, rfm_cluster_lastyear 187, cluster_style_lastyear 188, flag_anonymous 189, dt_observation 190, tec_dt_insert 191, period 192)\nFROM 'https://myec44datalake.dfs.core.windows.net/smack/smack/'\nWITH\n(\n\tFILE_TYPE = 'PARQUET'\n\t,MAXERRORS = 0\n\t,COMPRESSION = 'snappy'\n\t,IDENTITY_INSERT = 'OFF'\n)\n--END\nGO\n\nSELECT TOP 100 * FROM Kiabi.smack\nGO\n\nselect * from Kiabi.smack WHERE customer_rowid= \"20650476\" ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "SQLDB1",
				"type": "SqlPool"
			}
		},
		"type": "SqlQuery"
	}
}