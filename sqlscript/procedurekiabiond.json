{
	"name": "procedurekiabiond",
	"properties": {
		"folder": {
			"name": "hoda"
		},
		"content": {
			"query": "\nCREATE PROC [dbo].[Smackprepond]\n\nAS\nBEGIN\n\nIF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat] \n\tWITH ( FORMAT_TYPE = PARQUET);\n \nIF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapsecsvFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapsecsvFormat] \n\t\nWITH (  \n    FORMAT_TYPE = DELIMITEDTEXT,  \n    FORMAT_OPTIONS (  \n    FIELD_TERMINATOR = ';')\n)\n;\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'smack_myec44synapse_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [smack_myec44synapse_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'https://myec44synapse.dfs.core.windows.net/smack'\n\t\n\t);\n\n    IF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'smackprep_myec44synapse_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [smackprep_myec44synapse_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'https://myec44synapse.dfs.core.windows.net/smackprep', \n\t\n\t);\n\n  IF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'smackprepcsv_myec44synapse_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [smackprepcsv_myec44synapse_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'https://myec44synapse.dfs.core.windows.net/smackprepcsv'\n\t);\n\nCREATE EXTERNAL TABLE smack_et\n(\n    customer_rowid varchar(4000),\n     customer_create_date varchar(4000),\n     gender varchar(4000),\n     loyalty_card BIGINT,\n     loyalty_card_status varchar(4000),\n     personnel_kiabi varchar(4000),\n     flag_shared_loyalty_card varchar(4000),\n     customer_country varchar(4000),\n     customer_country_label varchar(4000),\n     birthdate varchar(4000),\n     slice_age varchar(4000),\n     address_quality_score bigint,\n     top_has_address varchar(4000),\n     top_has_telfixe varchar(4000),\n     top_has_gsm varchar(4000),\n     top_has_optinsms varchar(4000),\n     optin_email_kiabi varchar(4000),\n     optin_email_part varchar(4000),\n     nb_child bigint,\n     nb_child_boy bigint,\n     nb_child_girl bigint,\n     nb_child_unknown bigint,\n     first_purchase_date varchar(4000),\n     first_ticket_date varchar(4000),\n     first_order_date varchar(4000),\n     most_used_tckt_pay varchar(4000),\n     most_used_tckt_pay_12rm varchar(4000),\n     code_store_lastpurchase varchar(4000),\n     lati_store_lastpurchase varchar(4000),\n     long_store_lastpurchase varchar(4000),\n     tckt_last_purchase_date varchar(4000),\n     order_last_purchase_date varchar(4000),\n     last_purchase_date varchar(4000),\n     code_store_attac varchar(4000),\n     lati_store_attac varchar(4000),\n     long_store_attac varchar(4000),\n     code_store_open varchar(4000),\n     lati_store_open varchar(4000),\n     long_store_open varchar(4000),\n     nb_product_tckt_maternity_12rm bigint,\n     nb_tckt_return_1rm bigint,\n     nb_tckt_return_6rm bigint,\n     nb_tckt_return_12rm bigint,\n     nb_tckt_return_18rm bigint,\n     nb_tckt_return_24rm bigint,\n     nb_tckt_return_36rm bigint,\n     nb_tckt_return_48rm bigint,\n     nb_tckt_return_all bigint,\n     nb_tckt_1rm bigint,\n     nb_tckt_6rm bigint,\n     nb_tckt_12rm bigint,\n     nb_tckt_18rm bigint,\n     nb_tckt_24rm bigint,\n     nb_tckt_36rm bigint,\n     nb_tckt_48rm bigint,\n     nb_tckt_all bigint,\n     nb_product_order_maternity_12rm bigint,\n     nb_order_1rm BIGINT,\n     nb_order_6rm bigint,\n     nb_order_12rm bigint,\n     nb_order_18rm bigint,\n     nb_order_24rm bigint,\n     nb_order_36rm bigint,\n     nb_order_48rm bigint,\n     nb_order_all bigint,\n     most_used_order_delivery varchar(4000),\n     nb_order_desk_12rm bigint,\n     nb_order_mobile_12rm bigint,\n     nb_order_other_12rm bigint,\n     most_used_order_pay varchar(4000),\n     most_used_order_pay_12rm varchar(4000),\n     nb_tckt_articles_1rm bigint,\n     nb_tckt_articles_12rm bigint,\n     nb_tckt_articles_all bigint,\n     nb_tckt_return_articles_1rm bigint,\n     nb_tckt_return_articles_12rm bigint,\n     nb_tckt_return_articles_all bigint,\n     nb_order_articles_1rm bigint,\n     nb_order_articles_12rm bigint,\n     net_sales_tckt_1rm float,\n     net_sales_tckt_12rm float,\n     net_sales_tckt_all float,\n     net_sales_tckt_return_1rm float,\n     net_sales_tckt_return_12rm float,\n     net_sales_tckt_return_all float,\n     net_sales_order_1rm float,\n     net_sales_order_12rm float,\n     nb_order_eresa_1rm bigint,\n     nb_order_eresa_12rm bigint,\n     nb_order_eresa_all bigint,\n     potentiel_net_sales_eresa_1rm float,\n     potentiel_net_sales_eresa_12rm float,\n     potentiel_net_sales_eresa_all float,\n     customer_activity_kind_1rm varchar(4000),\n     customer_activity_kind_12rm varchar(4000),\n     customer_activity_xcanal_1rm varchar(4000),\n     customer_activity_xcanal_12rm varchar(4000),\n     customer_activity_xcanal_all varchar(4000),\n     product_groups_12rm varchar(4000),\n     product_groups_1rm varchar(4000),\n     product_groups_all varchar(4000),\n     rfm_date_observation varchar(4000),\n     rfm_min_date varchar(4000),\n     rfm_t1 BIGINT,\n     rfm_t2 BIGINT,\n     rfm_t3 BIGINT,\n     rfm_t4 BIGINT,\n     rfm_frequence BIGINT,\n     rfm_sum_ca_ttc float,\n     rfm_scorerfm float,\n     rfm_classerfm varchar(4000),\n     rfm_cluster varchar(4000),\n     cluster_style varchar(4000),\n     net_sales_grbaby_fashion_12rm float,\n     net_sales_grbaby_basic_12rm float,\n     net_sales_grbaby_12rm float,\n     net_sales_grkids_fashion_12rm float,\n     net_sales_grkids_basic_12rm float,\n     net_sales_grkids_12rm float,\n     net_sales_grwomen_fashion_12rm float,\n     net_sales_grwomen_basic_12rm float,\n     net_sales_grwomen_12rm float,\n     net_sales_grmen_fashion_12rm float,\n     net_sales_grmen_basic_12rm float,\n     net_sales_grmen_12rm float,\n     net_sales_grunderwear_fashion_12rm float,\n     net_sales_grunderwear_basic_12rm float,\n     net_sales_grunderwear_12rm float,\n     net_sales_grshoes_fashion_12rm float,\n     net_sales_grshoes_basic_12rm float,\n     net_sales_grshoes_12rm float,\n     net_sales_graccess_fashion_12rm float,\n     net_sales_graccess_basic_12rm float,\n     net_sales_graccess_12rm float,\n     net_sales_grexcluweb_fashion_12rm float,\n     net_sales_grexcluweb_basic_12rm float,\n     net_sales_grexcluweb_12rm float,\n     xcanal_cluster_12rm varchar(4000),\n     attac_store_dist float,\n     nearest_store varchar(4000),\n     nearest_store_dist float,\n     net_sales_tckt_pvi_1rm float,\n     net_sales_tckt_pvi_12rm float,\n     net_sales_order_pvi_1rm float,\n     net_sales_order_pvi_12rm float,\n     class_grwomen varchar(4000),\n     class_grmen varchar(4000),\n     class_grshoes varchar(4000),\n     class_grbaby varchar(4000),\n     class_grexcluweb varchar(4000),\n     class_graccess varchar(4000),\n     class_grconsign varchar(4000),\n     class_grhome varchar(4000),\n     class_grkids varchar(4000),\n     class_grunderwear varchar(4000),\n     first_purchase_canal varchar(4000),\n     slice_first_purchase_date varchar(4000),\n     score_mixite float,\n     main_appetence varchar(4000),\n     secondary_appetence varchar(4000),\n     marketappetence varchar(4000),\n     departmentappetence varchar(4000),\n     net_sales_tckt_6rm float,\n     net_sales_tckt_18rm float,\n     net_sales_tckt_24rm float,\n     net_sales_tckt_36rm float,\n     net_sales_order_6rm float,\n     net_sales_order_18rm float,\n     net_sales_order_24rm float,\n     net_sales_order_36rm float,\n     net_sales_order_all float,\n     nb_etckt_1rm BIGINT,\n     nb_etckt_6rm BIGINT,\n     nb_etckt_12rm BIGINT,\n     nb_etckt_all BIGINT,\n     net_sales_etckt_1rm float,\n     net_sales_etckt_6rm float,\n     net_sales_etckt_12rm float,\n     net_sales_etckt_all float,\n     cluster_evol_nb_24_12rm varchar(4000),\n     cluster_evol_nb_12rm varchar(4000),\n     cluster_evol_net_sales_24_12rm varchar(4000),\n     cluster_evol_net_sales_12rm varchar(4000),\n     percent_evol_net_sales_12rm float,\n     slice_evol_net_sales_12rm varchar(4000),\n     customer_activity_xcanal_12rm_lastyear varchar(4000),\n     rfm_cluster_lastyear varchar(4000),\n     cluster_style_lastyear varchar(4000),\n     flag_anonymous varchar(4000),\n     dt_observation varchar(4000),\n     tec_dt_insert varchar(4000),\n     period varchar(4000)\n)\nWITH (\n\tLOCATION = 'smack/',\n\tDATA_SOURCE = [smack_myec44synapse_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat],\n\tREJECT_TYPE = VALUE,\n\tREJECT_VALUE = 0\n\t)\n;\nEND\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "KiabiPOC",
				"type": "SqlOnDemand"
			}
		},
		"type": "SqlQuery"
	}
}